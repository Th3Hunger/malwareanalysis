Hello World, This Will Probably be My First Malware Report Where I will Reverse Ryuk Ransomware. So Before Getting into Technical Analysis and Reverse Engineering I will Provide Some Introduction to Ryuk. So The Typical Attack Flow of Ryuk is as Follows:

1- An maldoc Contains a malicious macro that will execute PowerShell. 

2- The PowerShell Command then Downloads Emotet Banking Trojan. 

3- Emotet Then Downloads TrickBot 

4- As A Typical Lateral Movement Activity TrickBot Downloads Ryuk 

5- Ryuk Then Tries to Encrypt all the Network Hosts 

Who Created It ? 
--------------------

So Attribution is Hard However From What I have Read Threat Intel Researches Suggest that it belongs to the Authors of HERMES which is a Ransomware first was detected in October 2017 was then arrtributed to an APT Group Called Lazarus Group. 

![Image of Yaktocat](https://1.bp.blogspot.com/-8vPh0iWPH64/X5x4JKdU96I/AAAAAAAAAw4/TyYFVhmVC14g5q1G4FdQHEdD1MvM2XMggCLcBGAsYHQ/w339-h400/330px-Cartel_de_la_orden_de_captura_de_Park_Jin_Hyok.png)

IOCS:
=====
SHA256: 40b865d1c3ab1b8544bcf57c88edd30679870d40b27d62feb237a19f0c5f9cd1
SHA1: AD11ED52AB33AD05EB9B1E9ADE134CA1348ACC81
MD5: 484a2bcb1335ac97ee91194f4c0964bc

IPs: 192.168.100.184

![Image of Yaktocat](https://1.bp.blogspot.com/-r6y1mBGj0kY/X58c7J4pcSI/AAAAAAAAA0g/RLdqXLTF97M8schlrfzTBaSsZHGaHmyLACLcBGAsYHQ/w400-h269/ip.PNG) 


TTPs:
=====

[+] Command-Line Interface [T1059](https://attack.mitre.org/techniques/T1059)

[+] Execution through API  [T1106](https://attack.mitre.org/techniques/T1106) 

[+] Service Execution   [T1035](https://attack.mitre.org/techniques/T1035)    

[+] Registry Run Keys / Startup Folder  [T1060](https://attack.mitre.org/techniques/T1060)

[+] Process Injection   [T1055](https://attack.mitre.org/techniques/T1055) 

[+] Disabling Security Tools [T1089](https://attack.mitre.org/techniques/T1089)

[+] File Permissions Modification [T1222](https://attack.mitre.org/techniques/T1222)

[+] Modify Registry [T1112](https://attack.mitre.org/techniques/T1112)

[+] Process Injection [T1055](https://attack.mitre.org/techniques/T1055)
 
[+] Query Registry [T1012](https://attack.mitre.org/techniques/T1012)

[+] System Service Discovery  [T1007](https://attack.mitre.org/techniques/T1007)
   
[+] Inhibit System Recovery  [T1490](https://attack.mitre.org/techniques/T1490)

[+] Access Token Manipulation [T1134](https://attack.mitre.org/techniques/T1134/)

[+] Process Discovery	[T1057](https://attack.mitre.org/techniques/T1057)

[+] Service Stop	[T1489](https://attack.mitre.org/techniques/T1489)

[+] Impair Defenses: Disable or Modify Tools [T1562](https://attack.mitre.org/techniques/T1562)

[+] Data Encrypted for Impact [T1486](https://attack.mitre.org/techniques/T1486)


In Depth Reversing:
===================

- When Executing the Sample It Drops a Copy From its Self and Execute it using "8 lan" Command. 

![Image of Yaktocat](https://1.bp.blogspot.com/-IFFpq8SNgWc/X58YS_IKO8I/AAAAAAAAA0I/mjXjqekwURgyw8W5fUqHe-pP0Uov7tbWwCLcBGAsYHQ/s320/ryukcopy.PNG)

- The Name of the Dropped Exe are Seven Random Charachters. 
- The Malware Injects Into 4 Process taskeng.exe, host.exe, dwm.exe, ctfmon.exe
- The Malware Deletes its Shadow Copies Using:
        cmd /c \"WMIC.exe shadowcopy delet\
        vssadmin.exe Delete Shadows /all /quiet
As You Can See a Typo Found in the First Command The Author Missed 'e' in delete. 

List of The Commands Executed:
===============================

[+] cmd /c \"WMIC.exe shadowcopy delet\

[+] icacls "C:\*" /grant Everyone:F /T /C /Q

[+] vssadmin.exe Delete Shadows /all /quiet

[+] bcdedit /set {default} recoveryenabled No & bcdedit /set {default}

[+] bootstatuspolicy ignoreallfailures

[+] "C:\Windows\System32\net.exe" stop "audioendpointbuilder" /y

[+] C:\Windows\system32\net1 stop "audioendpointbuilder" /y

[+] "C:\Windows\System32\net.exe" stop "samss" /y

[+] C:\Windows\system32\net1 stop "samss" /y

[+] "C:\Windows\System32\cmd.exe" /C REG ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "svchos" /t REG_SZ /d "C:\Users\admin\AppData\Local\Temp\USvoLou.exe" /

[+] REG  ADD "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "svchos" /t REG_SZ /d "C:\Users\admin\AppData\Local\Temp\860e50.exe" /f

![Image of Yaktocat](https://1.bp.blogspot.com/-a9ydezMuZ-I/X58bDGalosI/AAAAAAAAA0U/kRWACU0WdF8qe7gh-2mza9Suo92xogewQCLcBGAsYHQ/w640-h248/cutter.PNG)

Privilege Escalation:
=====================


